<!doctype html>
<html ng-app="feedsApp">
	<head>
		<script src="js/angular.min.js"></script>
		<script src="js/angular-animate.min.js"></script>
		<!-- <script src="js/angular-aria.min.js"></script>
		<script src="js/angular-messages.min.js"></script>
		<script src="js/angular-material.min.js"></script> -->
		<script src="js/main.js"></script>
		<link rel="stylesheet" type="text/css" href="css/main.css">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
		<!-- <link rel="stylesheet" href="css/angular-material.min.css"> -->
	</head>
	<body>
		<div ng-controller="feedsController" class="{{activateMainClass}}">
			<div class="leftCol">
				<i class="fa fa-cog fa-lg" ng-click="openDialog()"></i> {{currentUser}}
				<div ng-repeat="category in categories">
					<h4>{{category.Name}}</h4>
					<ul class="feedList">
						<li ng-repeat="feed in feeds | filter:{ IdCategory: category.IdCategory }" ng-show="feed.NbItems > category.ShowEmptyFeeds" ng-class="feed.IdFeed == currentFeedId ? 'current' : ''">
							<a href="" ng-click="feedLoad(feed.IdFeed)" title="{{ feed.Name }}">{{ feed.Name }}</a><span class="nbItems">{{ feed.NbItems }}</span>
						</li>
					</ul>
					<a href="" ng-click="toggleShowAll(category.IdCategory)">Show all</a>
				</div>
				<ul class="feedList">
					<li>
						<a href="" ng-click="loadSaved()">Saved items</a><span class="nbItems">{{ nbSavedItems }}</span>
					</li>
				</ul>
			</div>
			<div class="centerCol">
				<div class="feedActionHeader" ng-show="showHeader()"><a href="" ng-click="readAll()">Read all</a> | <a href="" ng-click="unreadAll()">Unread all</a></div>
				<div class="newsItem" ng-class="getItemClass(content)" id="newsItem{{content.IdFeedContent}}" data-id-feed="{{content.IdFeedContent}}" ng-repeat="content in feedContent">
					<div class="newsHeader">
						<i class="fa fa-check-square{{getState(content.IsRead)}}" ng-click="postRead(content, 1)"></i>&nbsp;
						<i class="fa fa-bookmark{{getState(content.IsSaved)}}" ng-click="postToggleSave(content)"></i>
						<h2 id="news{{content.IdFeedContent}}"><a id="newsLink{{content.IdFeedContent}}" href="{{content.Url}}">{{content.Title}}</a></h2>
						<h3>{{content.PublishedDate | date:'dd/MM/yyyy H:mm:ss'}} -- {{content.Author}}</h3>
					</div>
					<div class="newsContent" ng-bind-html="content.Content"></div>
				</div>
			</div>
			<div class="readLaterCol">
				<div class="newsLater" ng-repeat="later in laterContent">
					<h2 id="newsLater{{later.IdFeedContent}}"><a id="newsLaterLink{{later.IdFeedContent}}" href="{{later.Url}}">{{later.Title}}</a></h2>
				</div>
			</div>
		</div>

		<div ng-controller="setupController" class="setupDialog {{classShow}}">
			<div class="dialogHead">Configuration <i class="fa fa-times" style="float: right; cursor: pointer;" ng-click="closeDialog()"></i></div>
			<h4>Categories</h4>
			<div ng-repeat="category in categories" class="category" data-id="{{category.IdCategory}}">{{category.Name}} <i class="fa fa-trash" ng-show="category.IdCategory>=0" ng-click="deleteCategory(category.IdCategory)"></i></div><br />
			<input type="text" ng-model="categoryToAddName" placeholder="New category"> <i class="fa fa-plus" ng-click="addCategory()"></i>
			<h4>Feeds</h4>
			<input type="hidden" value="{{currentFeedId}}" />
			URL <input type="text" ng-model="feedToAddUrl" placeholder="URL du feed">
			Name <input type="text" ng-model="feedToAddName" placeholder="Nom du feed">
			<i class="fa fa-plus" ng-click="addFeed()"></i>
			<ul>
				<li ng-repeat="feed in feeds">
					<i class="fa fa-{{addOrRemove(feed)}}-circle" ng-click="feedChangeSubscription(feed)"></i><a href="" ng-click="showFeed(feed)">{{ feed.Name }}</a>
					<select ng-model="feed.IdCategory" ng-show="feed.IsSubscribed" ng-change="feedChangeCategory(feed)"
						ng-options="category.IdCategory as category.Name for category in categories">
						<!-- <option ng-repeat="category in categories" value="{{category.IdCategory}}" ng-selected="feed.IdCategory === category.IdCategory">{{category.Name}}</option> -->
					</select>
					<div ng-show="feed.IsShown">
						URL <input type="text" ng-model="feed.Url">
						Nom <input type="text" ng-model="feed.Name">
						<i class="fa fa-pencil" ng-click="editFeed(feed)"></i>
						<i class="fa fa-trash" ng-click="deleteFeed(feed)"></i>
					</div>
				</li>
			</ul>
		</div>
	</body>
</html>
